"""Change name of results to metrics report

Revision ID: a3ef9039001a
Revises: 42ecb8768678
Create Date: 2025-05-08 09:53:02.604198

"""

from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import sqlite

# revision identifiers, used by Alembic.
revision: str = "a3ef9039001a"
down_revision: Union[str, None] = "42ecb8768678"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column("federated_round_client_submissions", "metrics_report")
    op.add_column(
        "federated_round_client_submissions",
        sa.Column("metrics_report", sa.JSON(), nullable=True),
    )
    op.add_column(
        "federated_test_results", sa.Column("metrics_report", sa.JSON(), nullable=True)
    )
    op.drop_column("federated_test_results", "metrics")
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column(
        "federated_test_results", sa.Column("metrics", sqlite.JSON(), nullable=False)
    )
    op.drop_column("federated_test_results", "metrics_report")
    op.add_column(
        "federated_round_client_submissions",
        sa.Column("training_history", sqlite.JSON(), nullable=True),
    )
    op.drop_column("federated_round_client_submissions", "metrics_report")
    # ### end Alembic commands ###
